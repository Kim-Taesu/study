#### 집계 연산

- 집계 : 무언가를 함께 모으는 행위이며 빅데이터 분석의 초석
- 집계를 수행하려면 키나 그룹을 지정하고
  - 하나 이상의 ㅋ러럼을 변환하는 방법을 지정하는 집계 함수를 사용
- 여러 입력값이 주어지면 그룹별로 결과를 생성

#### 그룹화 데이터 타입 생성

- select 구문에서 집계를 수행하여 DataFrame의 전체 데이터를 요약
- `group by`는 하나 이상의 키를 지정할 수 있으며 값을 가진 컬럼을 변환하기 위해 다른 집계 함수를 사용할 수 있다.
- `윈도우(window)`는 하나 이상의 키를 지정할 수 있으며 값을 가진 컬럼을 변환하기 위해 다른 집계 함수를 사용
- `그룹화 셋(grouping set)`은 서로 다른 레벨의 값을 집계할 때 사용
  - SQL, DataFrame의 롤업 그리고 큐브를 사용할 수 있다.
- `롤업(rollup)`은 하나 이상의 키를 지정할 수 있다.
  - 컬럼을 변환하는 데 다른 집계 함수를 사용하여 계층적으로 요약된 값을 구할 수 있다.
- `큐브(cubd)`는 하나 이상으 ㅣ키를 지정할 수 있으며 값을 가진 컬럼을 변환하기 위해 다른 집계 함수를 사용
  - 큐브는 모든 컬럼 조합에 대한 요약 값을 계산

#### 지정된 집계 함수에 따라 그룹화된 결과는 `RelationalGroupedDataset`을 반환

#### 그룹화

- 하나 이상의 컬럼을 그룹화하고 집계 연산을 수행하는 두 단계로 이루어짐
  - 첫 번째 단계에서 `RelationalGroupedDataset`이 반환
  - 두 번째 단계에서 `DataFrame`이 반환
- 그룹의 기준이 되는 컬럼을 여러 개 지정할 수 있다.

#### 윈도우 함수

- 데이터의 특정 `윈도우`를 대상으로 고유의 집계 연산을 수행
- 데이터의 `윈도우`는 현재 데이터에 대한 참조를 사용해 정의
- 윈도우 명세는 함수에 전달될 로우를 결정
- 윈도우 함수는 프레임에 입력되는 모든 로우에 대해 결과값을 계산
  - `group-by` 함수를 사용하면 모든 로우 레코드가 단일 그룹으로만 이동
  - 가장 흔히 사용되는 `롤링 평균`
- 윈도우 함수
  - 랭크 함수
  - 분석 함수
  - 집계 함수

#### 윈도우 함수 정의

- 윈도우 명세를 만든다.
  - partitionBy : 그룹을 어떻게 나눌지 결정
  - orderBy : 파티션의 정렬 방ㅅ기을 정의
  - rowsBetween : 입력된 로우의 참조를 기반으로 프레임에 로우가 포함될 수 있는지를 결정