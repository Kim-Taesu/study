#### 스파크 데이터 타입으로 변환

- 데이터 타입 변환은 lit 함수를 사용
- lit 함수는 다른 언어의 데이터 타입을 스파크 데이터 타입에 맞게 변환

#### 스칼라 에서의 동등 비교

- 일치 : ===
  - equalTo 메소드 사용 가능
- 불일치 : =!=
  - not 메소드 사용 가능

#### 불리언 데이터 타입

- 불리언 식에는 일치 조건 뿐만 아니라 작다, 크다와 같은 비교 연산 조건을 사용할 수 있다.
- and 메서드나 or 메서드를 사용해서 불리언 표현식을 여러 부분에 지정할 수 있습니다.
- 불리언 표현식을 사용하는 경우 항상 모든 표현식을 and 메서드로 묶어 차례대로 필터를 적용해야 한다.
  - 불리언 문을 차례대로 표현하더라도 스파크는 내부적으로 and 구문을 필터 사이에 추가해 모든 필터를 하나의 문자응로 변환

#### 문자열 데이터 타입 다루기

| 함수    | 기능                                                         |
| ------- | ------------------------------------------------------------ |
| initcap | 주어진 문자열에서 공백으로 나뉘는 모든 단어의 첫 글자를 대문자로 변경 |
| lower   | 문자열 전체를 소문자로 변경                                  |
| upper   | 문자열 전체를 대문자로 변경                                  |
| trim    | 문자열의 좌측, 우측 공백 제거                                |



#### 사용자 정의 함수(UDF)

- 파이썬이나 스칼라 그리고 외부 라이브러리를 사용해 사용자가 원하는 형태로 트랜스포메이션을 만들 수 있게 한다.
- UDF는 하나 이상의 컬럼을 입력으로 받고 반환할 수 있다.
- 레코드별로 데이터를 처리하는 함수
- Spark에서의  UDF 실행
  - UDF 함수 만들고 테스트
  - 스파크에 등록하기 위해 드라이버에서 함수를 직렬화하고 네트워크를 통해 모든 익스큐터 프로세스로 전달
    - 스칼라나 자바로 함수를 작성했다면 JVM 환경에서만 사용 가능

